--USE Cyclistic

----The total_rides view shows the total number of rides by each rider type.

--CREATE VIEW total_rides AS
--SELECT 
--    member_casual,
--    COUNT(*) AS number_of_rides
--FROM All_2022_Trips
--GROUP BY member_casual;

----The avg_ride_length view shows average ride length for each type of rider.

--CREATE VIEW avg_ride_length AS
--SELECT 
--    member_casual, 
--    AVG(CAST((DATEPART(HOUR, ride_length) * 3600 
--      + DATEPART(MINUTE, ride_length) * 60 
--      + DATEPART(SECOND, ride_length)) AS BIGINT)) AS average_ride_length_in_seconds
--FROM All_2022_Trips
--GROUP BY member_casual;

----The start_locations_casual view shows what start locations are most popular among casual riders.

--CREATE VIEW start_locations_casual AS
--SELECT 
--    start_station_name,
--    COUNT(*) AS number_of_rides
--FROM All_2022_Trips
--WHERE member_casual = 'casual'
--GROUP BY start_station_name;

----The end_locations_casual view shows most popular destinations for casual riders.

--CREATE VIEW end_locations_casual AS
--SELECT 
--    end_station_name,
--    COUNT(*) AS number_of_rides
--FROM All_2022_Trips
--WHERE member_casual = 'casual'
--GROUP BY end_station_name;

----The start_locations_member view shows what start locations are most popular among members.

--CREATE VIEW start_locations_member AS
--SELECT 
--    start_station_name,
--    COUNT(*) AS number_of_rides
--FROM All_2022_Trips
--WHERE member_casual = 'member'
--GROUP BY start_station_name;

----The end_locations_member view shows most popular destinations for members.

--CREATE VIEW end_locations_member AS
--SELECT 
--    end_station_name,
--    COUNT(*) AS number_of_rides
--FROM All_2022_Trips
--WHERE member_casual = 'member'
--GROUP BY end_station_name;

----The preferred_rideable_type view shows which style of bike is preferable to each rider type.

--CREATE VIEW preferred_rideable_type AS
--SELECT 
--    rideable_type,
--    member_casual,
--    COUNT(*) AS count
--FROM 
--    All_2022_Trips
--GROUP BY 
--    rideable_type,
--    member_casual;

----The weekly_activity view shows how rider activity changes depending on the day of the week.

--CREATE VIEW weekly_activity AS
--SELECT
--    member_casual,
--    day_of_week,
--    COUNT(*) AS trip_count
--FROM All_2022_Trips
--GROUP BY
--    member_casual,
--    day_of_week;

----The monthly_activity view shows how rider activity varies from month to month.

--CREATE VIEW monthly_activity AS
--SELECT 
--    member_casual, 
--    DATENAME(MONTH, started_at) AS month, 
--    COUNT(*) AS number_of_rides 
--FROM 
--    All_2022_Trips 
--GROUP BY 
--    member_casual, 
--    DATENAME(MONTH, started_at);
